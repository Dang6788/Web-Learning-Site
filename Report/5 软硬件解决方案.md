# 软硬件解决方案

## 软件：基于Flask的Web框架



## 硬件：阿里云ECS服务器

### 阿里云ECS服务器配置

所谓ECS(Elastic Cloud Service)，即对服务器集群的计算、存储能力按需求进行抽象划分，从用户的角度看，弹性云服务和传统云服务在使用上并无区别，但实际上减少了不必要的资源浪费，并提高了性价比。本项目所使用的ECS服务器配置为：

+ CPU 1核
+ 内存 2GB
+ 操作系统 CentOS 7.3 64位

我们使用scp命令实现从本地到云服务器的文件上传和下载，例如从本地上传文件到服务器/home路径的命令为：

```scp -r 本机文件路径 root@120.55.46.84:/home/```

阿里云服务器登陆密码为：```Anten123```

### 阿里云ECS云服务器的安全组规则设置

在取得分配给ECS云服务器的公网IP地址，并在云服务器部署Nginx后，并不能够从本地浏览器通过http://120.55.46.84 进行直接访问。而在本地通过ping命令却能够与IP地址为120.55.46.84的节点建立连接。经查找后发现，阿里云ECS服务器默认的安全组规则中不包括http类型的连接，而仅支持通过地址段进行访问。因此，需要在安全组规则中添加HTTP(80)的规则，其中80为Web server的默认端口号。



此外，阿里云规定了ECS云服务出方向、入方向的IP地址和端口限制。在出方向的默认IP地址为172.20.221.192，是ECS实例访问公网、私网、或ECS云服务器其他实例方向，入方向则相反。入方向的IP地址为申请该云服务器时分配的IP地址，本项目中为120.55.46.84. 若需要从公网经特定端口对云服务器中的资源进行访问，则首先在阿里云服务器官网进行设置，设置界面如下。



![截屏2020-11-19 下午4.09.39](/Users/wanghanwen/Library/Application Support/typora-user-images/截屏2020-11-19 下午4.09.39.png)



在本项目的开发迭代过程中，我们为每一次在云服务器上的部署都添加了一个新的入方向端口，以回顾我们每一次迭代的改进，所有添加用于本项目的端口地址如下：

+ http://120.55.46.84:8080

+ http://120.55.46.84:8090

+ http://120.55.46.84:8100

+ http://120.55.46.84

其中http://120.55.46.84 采用默认80端口，为最终版本的Web程序项目，采用前述Nginx+ uWSGI的部署方案，其余先前版本则直接运行对应项目程序，监听相应端口的需求，即```nohup python app.py```其中app.py为主程序。



需要注意的是，如果直接运行项目，需要将主函数中的```host```参数设为出方向IP地址，端口则为入方向的端口，app.py的主函数如下：

```python
if __name__ == '__main__':
    app.run(host='172.20.221.192',port=8100,debug=True)
```

而如果采用Nginx+uWSGI架构，即已经在该架构中连接了此应用程序，主函数中的host参数则为云服务器主机的IP地址——即出方向的IP地址120.55.46.84，使得其他用户通过该IP地址建立连接并发送请求时能分配给此应用程序，app.py的主函数如下：

```python
if __name__ == '__main__':
    app.run(host="120.55.46.84", port=80,debug=True)
```

